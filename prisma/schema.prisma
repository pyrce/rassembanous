// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model roles{
  id        Int     @id @default(autoincrement())
  nomRole String    @db.VarChar(50)
  users users[]
}

model users{
  id        Int     @id @default(autoincrement())
  nom String    @db.VarChar(50)
  prenom String    @db.VarChar(50)
  login String    @db.VarChar(50)
  password String    @db.VarChar(100)
  adresse String    @db.VarChar(100)
  email String    @db.VarChar(50)
  token String?    @db.VarChar(100)
  role   roles?   @relation(fields:  [id_role], references: [id])
  id_role Int
  mypartenaire partenaire_user[] @relation("mypartenaire")
  user partenaire_user[] @relation("user")
  media media[] @relation("mediauser")
  partenaireStand event_stand[]
  userevent event_user[] @relation("userevent")
  userquestion question_user[] @relation("userquestion")
}

model categories{
  id        Int     @id @default(autoincrement())
  categorie String    @db.VarChar(50)
  icon String    @db.VarChar(50)
  events evenements[]
}

model evenements {
  id              Int           @id @default(autoincrement())
  nom           String    @db.VarChar(50)
  description         String    @db.VarChar(250)
  id_lieu Int
  id_categorie Int
  lieu lieu?  @relation(fields:  [id_lieu], references: [id])
  categorie    categories?   @relation(fields:  [id_categorie], references: [id])
  dateDebut DateTime
  dateFin DateTime
  dateLimit DateTime
  isPublic Boolean
  nbPlace Int
  prix Int
  affiche String    @db.VarChar(50)
  media media[] @relation("mediaevent")
  eventStand event_stand[]
  eventuser event_user[] @relation("eventuser")
  questionnaire questionnaire[] @relation("eventquestionnaire")
}

model partenaire_user{
  id              Int           @id @default(autoincrement())
  id_partenaire Int
  mypartenaire    users?   @relation("mypartenaire",fields:  [id_partenaire], references: [id])
  id_user Int
  user    users?   @relation("user",fields:  [id_user], references: [id])
}

model mediatype{
  id              Int           @id @default(autoincrement())
libelle String    @db.VarChar(50)
media media[] @relation("mediatype")
}

model media{
  id              Int           @id @default(autoincrement())
image String    @db.VarChar(50)
id_event Int
id_user Int?
id_type Int
user    users?   @relation("mediauser",fields:  [id_user], references: [id])
event evenements? @relation("mediaevent",fields:  [id_event], references: [id])
typeId mediatype?  @relation("mediatype",fields:  [id_type], references: [id])
}

model lieu {
    id              Int           @id @default(autoincrement())
    nomLieu String    @db.VarChar(50)
    adresse String    @db.VarChar(50)
    stands stands[]
    events evenements[]
}

model stands{
  id              Int           @id @default(autoincrement())
  nomStand String    @db.VarChar(50)
  id_lieu Int
  idLieu lieu? @relation(fields:  [id_lieu], references: [id])
  eventStand event_stand[] 
}

model event_stand{
    id              Int           @id @default(autoincrement())
    id_stand Int?
    id_event Int
    id_user Int
    activite String
    idStand stands? @relation(fields:  [id_stand], references: [id])
    idEvent evenements? @relation(fields:  [id_event], references: [id])
    idUser users? @relation(fields:  [id_user], references: [id])
}

model event_user{
    id              Int           @id @default(autoincrement())
    id_event Int
    id_user Int
    idEvent evenements? @relation("eventuser",fields:  [id_event], references: [id])
    idUser users? @relation("userevent",fields:  [id_user], references: [id])
}

model questionnaire{
    id              Int           @id @default(autoincrement())
    id_event Int
    libelle String    @db.VarChar(50)
    questionnaire evenements? @relation("eventquestionnaire",fields:  [id_event], references: [id])
    questions questions[]
}

model questions{
      id              Int           @id @default(autoincrement())
      id_questionnaire Int
      question String    @db.VarChar(50)
      idQuestionnaire questionnaire @relation(fields:  [id_questionnaire], references: [id])
      users question_user[]
}

model question_user{
        id              Int           @id @default(autoincrement())
        id_user Int
        id_question Int
        stars Float
        iduser users? @relation("userquestion",fields:  [id_user], references: [id])
        idquestion questions @relation(fields:  [id_question], references: [id])
}